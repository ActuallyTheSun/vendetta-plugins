(function(u,i,a,g,o,m,h,c,M){"use strict";function S(){return M.useProxy(o.storage),React.createElement(c.ErrorBoundary,null,React.createElement(a.ReactNative.ScrollView,null,React.createElement(c.Forms.FormSwitchRow,{label:"Split messages on words instead of newlines",subLabel:"Results in the lowest amount of messages",onValueChange:function(s){return o.storage.splitOnWords=s},value:o.storage.splitOnWords})))}let l;o.storage.splitOnWords??=!1;function _(s){return new Promise(function(r){return setTimeout(r,s)})}function p(s,r){const t=[];return o.storage.splitOnWords||t.push(s.split(`
`).reduce(function(e,n){return e.length+n.length+2>r?(t.push(e),n+`
`):e?e+n+`
`:n+`
`},"")),t.length&&!t.some(function(e){return e.length>r})?t.map(function(e){return e.trim()}):(t.length=0,t.push(s.split(" ").reduce(function(e,n){return e.length+n.length+2>r?(t.push(e),n+" "):e?e+n+" ":n+" "},"")),t.some(function(e){return e.length>r})?!1:t.map(function(e){return e.trim()}))}var A={onLoad(){const s=i.findByStoreName("UserStore").getCurrentUser()?.premiumType===2?4e3:2e3;a.constants.MAX_MESSAGE_LENGTH=Number.MAX_SAFE_INTEGER,a.constants.MAX_MESSAGE_LENGTH_PREMIUM=Number.MAX_SAFE_INTEGER;const r=i.findByStoreName("ChannelStore"),t=i.findByProps("sendMessage","editMessage");l?.(),l=g.instead("sendMessage",t,function(e,n){const[d,{content:f}]=e;if(f?.length<s)return n(...e);const E=p(f,s);if(!E)return h.showToast("Failed to split message",m.getAssetIDByName("Small"));const v=r.getChannel(d);(async function(){for(const N of E)await n(d,{...e[1],content:N}),await _(Math.max(v.rateLimitPerUser,1e3))})()})},onUnload:function(){l(),a.constants.MAX_MESSAGE_LENGTH=2e3,a.constants.MAX_MESSAGE_LENGTH_PREMIUM=4e3},settings:S};return u.default=A,Object.defineProperty(u,"__esModule",{value:!0}),u})({},vendetta.metro,vendetta.metro.common,vendetta.patcher,vendetta.plugin,vendetta.ui.assets,vendetta.ui.toasts,vendetta.ui.components,vendetta.storage);
