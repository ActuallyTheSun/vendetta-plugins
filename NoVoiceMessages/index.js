(function(c,l,i,s,m,u,v){"use strict";function g(t,e){s.storage[t]=e,e?a[t].onEnable():a[t].onDisable()}function d(){return v.useProxy(s.storage),React.createElement(u.ErrorBoundary,null,React.createElement(m.ReactNative.ScrollView,null,React.createElement(u.Forms.FormSwitchRow,{label:"Remove voice message button from chat",onValueChange:function(t){return g("voiceMessageButton",t)},value:s.storage.voiceMessageButton}),React.createElement(u.Forms.FormSwitchRow,{label:"Remove voice messages altogether",subLabel:"Requires restart to remove already received voice messages",onValueChange:function(t){return g("voiceMessages",t)},value:s.storage.voiceMessages})))}const b=1n<<46n,a={voiceMessageButton:{byDefault:!0,onEnable(){const t=l.findByStoreName("PermissionStore");o.voiceMessageButton.push(i.instead("can",t,function(e,n){return e[0]===b&&!e[2]?!1:n(...e)}))},onDisable(){f("voiceMessageButton")}},voiceMessages:{byDefault:!1,onEnable(){const t=l.findByProps("handleMessageUpdate","handleLoadMessagesSuccess")?.actions;if(!t)return console.error("[NoVoiceMessages] Failed to find action handlers for MessageStore!");o.voiceMessages.push(i.before("LOAD_MESSAGES_SUCCESS",t,function(e){e[0].messages&&=e[0].messages.filter(function(n){return n.attachments?.every(function(r){return!r.waveform})})}),i.before("MESSAGE_CREATE",t,function(e){e[0].message?.attachments?.some(function(n){return n.waveform})&&(e[0].message={})}),i.before("MESSAGE_UPDATE",t,function(e){e[0].message?.attachments?.some(function(n){return n.waveform})&&(e[0].message={})}))},onDisable(){f("voiceMessages")}}},o={voiceMessageButton:[],voiceMessages:[]};function f(t){t?(o[t].forEach(function(e){return e()}),o[t].splice(0,o[t].length)):Object.entries(o).forEach(function(e){let[n,r]=e;r.forEach(function(M){return M()}),o[n].splice(0,o[n].length)})}Object.entries(a).forEach(function(t){let[e,{byDefault:n}]=t;e in s.storage||(s.storage[e]=n)});var E={onLoad:function(){const t=s.storage;Object.entries(a).forEach(function(e){let[n,r]=e;t[n]&&r.onEnable()})},onUnload:f,settings:d};return c.default=E,c.settingsObj=a,Object.defineProperty(c,"__esModule",{value:!0}),c})({},vendetta.metro,vendetta.patcher,vendetta.plugin,vendetta.metro.common,vendetta.ui.components,vendetta.storage);
