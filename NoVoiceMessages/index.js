(function(u,b,g,l,r,f,E){"use strict";function d(e,t){r.storage[e]=t,t?c[e].onEnable():c[e].onDisable()}function h(){return E.useProxy(r.storage),React.createElement(f.ErrorBoundary,null,React.createElement(g.ReactNative.ScrollView,null,React.createElement(f.Forms.FormSwitchRow,{label:"Remove voice message button from chat",onValueChange:function(e){return d("voiceMessageButton",e)},value:r.storage.voiceMessageButton}),React.createElement(f.Forms.FormSwitchRow,{label:"Remove voice messages altogether",subLabel:"Requires restart to remove already received voice messages",onValueChange:function(e){return d("voiceMessages",e)},value:r.storage.voiceMessages})))}const M=1n<<46n,c={voiceMessageButton:{byDefault:!0,onEnable(){const e=b.findByStoreName("PermissionStore");a.voiceMessageButton.push(l.instead("can",e,function(t,o){return t[0]===M?!1:o(...t)}))},onDisable(){m("voiceMessageButton")}},voiceMessages:{byDefault:!1,onEnable(){const e=g.FluxDispatcher._actionHandlers._orderedActionHandlers,[t,o,i]=Object.entries(e).filter(function(n){let[s]=n;return["LOAD_MESSAGES_SUCCESS","MESSAGE_CREATE","MESSAGE_UPDATE"].includes(s)}).map(function(n){let[s,v]=n;return v.find(function(R){return R.name==="MessageStore"})});a.voiceMessages.push(l.before("actionHandler",t,function(n){n[0].messages&&=n[0].messages.filter(function(s){return s.attachments?.every(function(v){return!v.waveform})})}),l.before("actionHandler",o,function(n){n[0].message?.attachments?.some(function(s){return s.waveform})&&(n[0].message={})}),l.before("actionHandler",i,function(n){n[0].message?.attachments?.some(function(s){return s.waveform})&&(n[0].message={})}))},onDisable(){m("voiceMessages")}}},a={voiceMessageButton:[],voiceMessages:[]};function m(e){e?(a[e].forEach(function(t){return t()}),a[e].splice(0,a[e].length)):Object.entries(a).forEach(function(t){let[o,i]=t;i.forEach(function(n){return n()}),a[o].splice(0,a[o].length)})}Object.entries(c).forEach(function(e){let[t,{byDefault:o}]=e;t in r.storage||(r.storage[t]=o)});var S={onLoad:function(){const e=r.storage;Object.entries(c).forEach(function(t){let[o,i]=t;e[o]&&i.onEnable()})},onUnload:m,settings:h};return u.default=S,u.settingsObj=c,Object.defineProperty(u,"__esModule",{value:!0}),u})({},vendetta.metro,vendetta.metro.common,vendetta.patcher,vendetta.plugin,vendetta.ui.components,vendetta.storage);
